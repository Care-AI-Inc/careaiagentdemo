# Use roundcube/roundcubemail:latest as base image
FROM roundcube/roundcubemail:latest

# Add any additional configurations or customizations here if needed

# Example: Set environment variables
# ENV ROUNDCUBE_SKIN=elastic

# Example: Install additional PHP extensions if required
# RUN apt-get update && apt-get install -y \
#     php-imagick \
#     && apt-get clean \
#     && rm -rf /var/lib/apt/lists/*

# Example: Copy custom configuration files
# COPY config.inc.php /var/www/html/config/

# Example: Set permissions
# RUN chown -R www-data:www-data /var/www/html

# The CMD instruction is already set in the base image, so we don't need to specify it again
# Copy custom configuration file
COPY roundcube/www/config/config.inc.php /var/www/html/config/

# Set correct permissions for the config file
RUN chown www-data:www-data /var/www/html/config/config.inc.php && \
    chmod 644 /var/www/html/config/config.inc.php

# Copy the reply_suggestion plugin
COPY roundcube/www/plugins/reply_suggestion /var/www/html/plugins/reply_suggestion

# Set correct permissions for the plugin directory
RUN chown -R www-data:www-data /var/www/html/plugins/reply_suggestion && \
    chmod -R 755 /var/www/html/plugins/reply_suggestion
